plotPCA(frequency[["parietalStimulus"]][["data"]], frequency[["parietalStimulus"]][["variance"]], "frequency")
}
# Combine plots
{
plotTemporal = plot_grid(
plotFrontStimTemp,
plotParStimTemp,
plotFrontRespTemp,
plotParRespTemp,
labels = c("Fz", "Pz", "Fz", "Pz"),
label_size = 12,
hjust = -0.15,
vjust = 2,
nrow = 4,
align = "v"
) +
draw_label(
"Temporal PCA",
x = 0.5,
y = 0.9975,
hjust = 0.5,
vjust = 1,
size = 12,
colour = "black",
fontface = "bold"
) +
draw_label(
"Time (ms)",
x = 0.5,
y = 0.01,
hjust = 0.5,
vjust = 0,
size = 10,
colour = "black"
)
plotFrequency = plot_grid(
plotFrontStimFreq,
plotParStimFreq,
plotFrontRespFreq,
plotParRespFreq,
labels = c("Fz", "Pz", "Fz", "Pz"),
label_size = 12,
hjust = -0.15,
vjust = 2,
ncol = 1,
nrow = 4,
align = "v"
) +
draw_label(
"Frequency PCA",
x = 0.5,
y = 0.9975,
hjust = 0.5,
vjust = 1,
size = 12,
colour = "black",
fontface = "bold"
) +
draw_label(
"Frequency (Hz)",
x = 0.5,
y = 0.01,
hjust = 0.5,
vjust = 0,
size = 10,
colour = "black"
)
plotSummary = plot_grid(plotTemporal,
plotFrequency,
ncol = 2,
align = "h") +
draw_line(
x = c(0, 1),
y = c(0.515, 0.515),
size = 1,
colour = "black",
linetype = 2
)
}
# Generate Plots
{
plotFrontRespTemp <-
plotPCA(temporal[["frontalResponse"]][["data"]], temporal[["frontalResponse"]][["variance"]], "response")
plotFrontStimTemp <-
plotPCA(temporal[["frontalStimulus"]][["data"]], temporal[["frontalStimulus"]][["variance"]], "stimulus")
plotParRespTemp <-
plotPCA(temporal[["parietalResponse"]][["data"]], temporal[["parietalResponse"]][["variance"]], "response")
plotParStimTemp <-
plotPCA(temporal[["parietalStimulus"]][["data"]], temporal[["parietalStimulus"]][["variance"]], "stimulus")
plotFrontRespFreq <-
plotPCA(frequency[["frontalResponse"]][["data"]], frequency[["frontalResponse"]][["variance"]], "frequency")
plotFrontStimFreq <-
plotPCA(frequency[["frontalStimulus"]][["data"]], frequency[["frontalStimulus"]][["variance"]], "frequency")
plotParRespFreq <-
plotPCA(frequency[["parietalResponse"]][["data"]], frequency[["parietalResponse"]][["variance"]], "frequency")
plotParStimFreq <-
plotPCA(frequency[["parietalStimulus"]][["data"]], frequency[["parietalStimulus"]][["variance"]], "frequency")
}
# Combine plots
{
plotTemporal = plot_grid(
plotFrontStimTemp,
plotParStimTemp,
plotFrontRespTemp,
plotParRespTemp,
labels = c("Fz", "Pz", "Fz", "Pz"),
label_size = 12,
hjust = -0.15,
vjust = 2,
nrow = 4,
align = "v"
) +
draw_label(
"Temporal PCA",
x = 0.5,
y = 0.9975,
hjust = 0.5,
vjust = 1,
size = 12,
colour = "black",
fontface = "bold"
) +
draw_label(
"Time (ms)",
x = 0.5,
y = 0.01,
hjust = 0.5,
vjust = 0,
size = 10,
colour = "black"
)
plotFrequency = plot_grid(
plotFrontStimFreq,
plotParStimFreq,
plotFrontRespFreq,
plotParRespFreq,
labels = c("Fz", "Pz", "Fz", "Pz"),
label_size = 12,
hjust = -0.15,
vjust = 2,
ncol = 1,
nrow = 4,
align = "v"
) +
draw_label(
"Frequency PCA",
x = 0.5,
y = 0.9975,
hjust = 0.5,
vjust = 1,
size = 12,
colour = "black",
fontface = "bold"
) +
draw_label(
"Frequency (Hz)",
x = 0.5,
y = 0.01,
hjust = 0.5,
vjust = 0,
size = 10,
colour = "black"
)
plotSummary = plot_grid(plotTemporal,
plotFrequency,
ncol = 2,
align = "h") +
draw_line(
x = c(0, 1),
y = c(0.515, 0.515),
size = 1,
colour = "black",
linetype = 2
)
}
plotPCA <- function(plotData, varData, window) {
if (window == "stimulus") {
xRange = seq(0, 2000, 500)
index = "time"
} else if (window == "response") {
xRange = seq(-2000, 0, 500)
index = "time"
} else if (window == "frequency") {
xRange = seq(0, 30, 5)
index = "frequency"
}
tempLabels = varData
tempData = plotData
output = ggplot(data = tempData,
aes_string(x = index,
y = "value")) +
geom_freqpoly(aes(colour = variable,
group = rev(variable)),
stat = "identity",
size = 1) +
scale_colour_manual(values = rev(getPalette(colourCount))) +
geom_text(
data = tempLabels,
aes(
label = label,
y = 1.25,
x = x,
angle = 40
),
colour = "black",
size = 2.5
) +
coord_cartesian(ylim = c(-0.5, 1.5)) +
scale_x_continuous(breaks = xRange,
expand = c(0, 0)) +
theme_bw() +
theme(
plot.margin = unit(c(.5, .5, .5, .5), "cm"),
legend.position = "none",
axis.line.x = element_line(color = "black", size = 0.5),
axis.line.y = element_line(color = "black", size = 0.5),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
panel.border = element_blank()
)
return(output)
}
# Generate Plots
{
plotFrontRespTemp <-
plotPCA(temporal[["frontalResponse"]][["data"]], temporal[["frontalResponse"]][["variance"]], "response")
plotFrontStimTemp <-
plotPCA(temporal[["frontalStimulus"]][["data"]], temporal[["frontalStimulus"]][["variance"]], "stimulus")
plotParRespTemp <-
plotPCA(temporal[["parietalResponse"]][["data"]], temporal[["parietalResponse"]][["variance"]], "response")
plotParStimTemp <-
plotPCA(temporal[["parietalStimulus"]][["data"]], temporal[["parietalStimulus"]][["variance"]], "stimulus")
plotFrontRespFreq <-
plotPCA(frequency[["frontalResponse"]][["data"]], frequency[["frontalResponse"]][["variance"]], "frequency")
plotFrontStimFreq <-
plotPCA(frequency[["frontalStimulus"]][["data"]], frequency[["frontalStimulus"]][["variance"]], "frequency")
plotParRespFreq <-
plotPCA(frequency[["parietalResponse"]][["data"]], frequency[["parietalResponse"]][["variance"]], "frequency")
plotParStimFreq <-
plotPCA(frequency[["parietalStimulus"]][["data"]], frequency[["parietalStimulus"]][["variance"]], "frequency")
}
# Combine plots
{
plotTemporal = plot_grid(
plotFrontStimTemp,
plotParStimTemp,
plotFrontRespTemp,
plotParRespTemp,
labels = c("Fz", "Pz", "Fz", "Pz"),
label_size = 12,
hjust = -0.15,
vjust = 2,
nrow = 4,
align = "v"
) +
draw_label(
"Temporal PCA",
x = 0.5,
y = 0.9975,
hjust = 0.5,
vjust = 1,
size = 12,
colour = "black",
fontface = "bold"
) +
draw_label(
"Time (ms)",
x = 0.5,
y = 0.01,
hjust = 0.5,
vjust = 0,
size = 10,
colour = "black"
)
plotFrequency = plot_grid(
plotFrontStimFreq,
plotParStimFreq,
plotFrontRespFreq,
plotParRespFreq,
labels = c("Fz", "Pz", "Fz", "Pz"),
label_size = 12,
hjust = -0.15,
vjust = 2,
ncol = 1,
nrow = 4,
align = "v"
) +
draw_label(
"Frequency PCA",
x = 0.5,
y = 0.9975,
hjust = 0.5,
vjust = 1,
size = 12,
colour = "black",
fontface = "bold"
) +
draw_label(
"Frequency (Hz)",
x = 0.5,
y = 0.01,
hjust = 0.5,
vjust = 0,
size = 10,
colour = "black"
)
plotSummary = plot_grid(plotTemporal,
plotFrequency,
ncol = 2,
align = "h") +
draw_line(
x = c(0, 1),
y = c(0.515, 0.515),
size = 1,
colour = "black",
linetype = 2
)
}
# Save Plot
{
ggsave(
filename = "../../Data/MedEd/Plots/PCA_Plot.png",
plot = plotSummary,
width = 13.08,
height = 13.08,
dpi = 600
)
}
# Combine plots
{
plotTemporal = plot_grid(
plotFrontStimTemp,
plotParStimTemp,
plotFrontRespTemp,
plotParRespTemp,
labels = c("Fz", "Pz", "Fz", "Pz"),
label_size = 12,
hjust = -0.15,
vjust = 2,
nrow = 4,
align = "v"
) +
draw_label(
"Temporal PCA",
x = 0.5,
y = 0.9975,
hjust = 0.5,
vjust = 1,
size = 12,
colour = "black",
fontface = "bold"
) +
draw_label(
"Time (ms)",
x = 0.5,
y = 0.01,
hjust = 0.5,
vjust = 0,
size = 10,
colour = "black"
)
plotFrequency = plot_grid(
plotFrontStimFreq,
plotParStimFreq,
plotFrontRespFreq,
plotParRespFreq,
labels = c("Fz", "Pz", "Fz", "Pz"),
label_size = 12,
hjust = -0.15,
vjust = 2,
ncol = 1,
nrow = 4,
align = "v"
) +
draw_label(
"Frequency PCA",
x = 0.5,
y = 0.9975,
hjust = 0.5,
vjust = 1,
size = 12,
colour = "black",
fontface = "bold"
) +
draw_label(
"Frequency (Hz)",
x = 0.5,
y = 0.01,
hjust = 0.5,
vjust = 0,
size = 10,
colour = "black"
)
plotSummary = plot_grid(plotTemporal,
plotFrequency,
ncol = 2,
align = "h") +
draw_line(
x = c(0, 1),
y = c(0.505, 0.505),
size = 1,
colour = "black",
linetype = 2
)
}
# Save Plot
{
ggsave(
filename = "../../Data/MedEd/Plots/PCA_Plot.png",
plot = plotSummary,
width = 13.08,
height = 13.08,
dpi = 600
)
}
# Combine plots
{
plotTemporal = plot_grid(
plotFrontStimTemp,
plotParStimTemp,
plotFrontRespTemp,
plotParRespTemp,
labels = c("Fz", "Pz", "Fz", "Pz"),
label_size = 12,
hjust = -0.15,
vjust = 2,
nrow = 4,
align = "v"
) +
draw_label(
"Temporal PCA",
x = 0.5,
y = 0.9975,
hjust = 0.5,
vjust = 1,
size = 12,
colour = "black",
fontface = "bold"
) +
draw_label(
"Time (ms)",
x = 0.5,
y = 0.01,
hjust = 0.5,
vjust = 0,
size = 10,
colour = "black"
)
plotFrequency = plot_grid(
plotFrontStimFreq,
plotParStimFreq,
plotFrontRespFreq,
plotParRespFreq,
labels = c("Fz", "Pz", "Fz", "Pz"),
label_size = 12,
hjust = -0.15,
vjust = 2,
ncol = 1,
nrow = 4,
align = "v"
) +
draw_label(
"Frequency PCA",
x = 0.5,
y = 0.9975,
hjust = 0.5,
vjust = 1,
size = 12,
colour = "black",
fontface = "bold"
) +
draw_label(
"Frequency (Hz)",
x = 0.5,
y = 0.01,
hjust = 0.5,
vjust = 0,
size = 10,
colour = "black"
)
plotSummary = plot_grid(plotTemporal,
plotFrequency,
ncol = 2,
align = "h") +
draw_line(
x = c(0, 1),
y = c(0.505, 0.505),
size = 1,
colour = "black",
linetype = 2
) +
draw_line(
x = c(0.495, 0.495),
y = c(0, 1),
size = 1,
colour = "black",
linetype = 2
)
}
# Save Plot
{
ggsave(
filename = "../../Data/MedEd/Plots/PCA_Plot.png",
plot = plotSummary,
width = 13.08,
height = 13.08,
dpi = 600
)
}
